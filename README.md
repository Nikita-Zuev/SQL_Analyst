# Аналіз податкової амортизації основних засобів підприємства

## Мета запиту
SQL-запит для детального розрахунку та аналізу податкової амортизації основних засобів підприємства. Враховує різні сценарії використання активів (повний період, частковий період, виведення з експлуатації).

---

## Ключові етапи

1.  **Збір даних**: Об'єднання інформації про активи, їхню вартість, строк використання та метод амортизації за допомогою `LEFT JOIN`.

2.  **Розрахунок амортизації**: Використання конструкції `CASE WHEN` для обчислення амортизації з урахуванням різних ситуацій:
    * Повний робочий період.
    * Введення в експлуатацію впродовж періоду.
    * Виведення з експлуатації або поліпшення.

3.  **Формування підсумків**: Агрегація даних за допомогою `SUM` і `AVG`. Додавання підсумкового рядка "TOTAL" за допомогою `UNION ALL`.

---

## Обробка помилок та оптимізація

* **Обробка помилок**: Застосування `COALESCE()` для заміни `NULL` на дефолтні значення (`0` або `1`). Умови у `CASE WHEN` перевіряють наявність даних та їхню відповідність бізнес-логіці.

* **Оптимізація**:
    * Розбиття логіки на кілька `CTE` для поліпшення читабельності та підтримки.
    * Використання параметрів `:selection_start_date` та `:selection_end_date` для гнучкості.
    * Оптимізація `JOIN` операцій шляхом перенесення вибірки основних полів до фінального `CTE`.

---

* ## Технічні вимоги

    * СУБД: Oracle (використовуються Oracle-специфічні функції)
    * Параметри: Обов'язкові параметри початкової та кінцевої дати періоду
